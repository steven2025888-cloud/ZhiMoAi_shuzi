[MODEL] 正在加载 IndexTTS2 声学模型...
[MODEL] PyTorch CUDA可用: True
[MODEL] GPU设备: NVIDIA GeForce RTX 3080
[MODEL] CUDA版本: 12.8
>> GPT weights restored from: D:\ZhiMoAi_shuzi\_internal_tts\checkpoints\gpt.pth
GPT2InferenceModel has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From \U0001f449v4.50\U0001f448 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
>> Failed to load custom CUDA kernel for BigVGAN. Falling back to torch.
TypeError("unsupported operand type(s) for +: 'NoneType' and 'str'")
>> semantic_codec weights restored from: D:\ZhiMoAi_shuzi\_internal_tts\checkpoints\hf_cache\models--amphion--MaskGCT\snapshots\265c6cef07625665d0c28d2faafb1415562379dc\semantic_codec\model.safetensors
cfm loaded
length_regulator loaded
gpt_layer loaded
>> s2mel weights restored from: D:\ZhiMoAi_shuzi\_internal_tts\checkpoints\s2mel.pth
>> campplus_model weights restored from: D:\ZhiMoAi_shuzi\_internal_tts\checkpoints\hf_cache\models--funasr--campplus\snapshots\fb71fe990cbf6031ae6987a2d76fe64f94377b7e\campplus_cn_common.bin
Loading weights from nvidia/bigvgan_v2_22khz_80band_256x
Removing weight norm...
>> bigvgan weights restored from: nvidia/bigvgan_v2_22khz_80band_256x
>> TextNormalizer loaded
>> bpe model loaded from: D:\ZhiMoAi_shuzi\_internal_tts\checkpoints\bpe.model
[MODEL] 模型加载完成，正在预热引擎...
>> starting inference...
Use the specified emotion vector
The following generation flags are not valid and may be ignored: ['length_penalty']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.53.0. You should pass an instance of `Cache` instead, e.g. `past_key_values=DynamicCache.from_legacy_cache(past_key_values)`.
  0%|          | 0/25 [00:00<?, ?it/s]  4%|         | 1/25 [00:00<00:02,  9.13it/s] 28%|       | 7/25 [00:00<00:00, 34.90it/s] 44%|     | 11/25 [00:00<00:00, 26.71it/s] 56%|    | 14/25 [00:00<00:00, 24.45it/s] 68%|   | 17/25 [00:00<00:00, 23.26it/s] 80%|  | 20/25 [00:00<00:00, 22.37it/s] 92%|| 23/25 [00:00<00:00, 21.89it/s]100%|| 25/25 [00:01<00:00, 22.99it/s]
torch.Size([1, 21504])
>> gpt_gen_time: 0.86 seconds
>> gpt_forward_time: 0.01 seconds
>> s2mel_time: 1.09 seconds
>> bigvgan_time: 0.25 seconds
>> Total inference time: 3.13 seconds
>> Generated audio length: 0.98 seconds
>> RTF: 3.2125
>> wav file saved to: D:\ZhiMoAi_shuzi\unified_outputs\_warmup.wav
[MODEL] 引擎预热完成，首次合成将直接输出
[MODEL] OK
[LS-SERVER] 常驻推理服务将在首次视频生成时懒启动
[TextExtractor] 后台线程已启动
[TextExtractor] WebSocket 连接已在后台初始化
[TextExtractor] WebSocket 连接成功
>> starting inference...
Use the specified emotion vector
The following generation flags are not valid and may be ignored: ['length_penalty']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  0%|          | 0/25 [00:00<?, ?it/s] 24%|       | 6/25 [00:00<00:00, 47.53it/s] 44%|     | 11/25 [00:00<00:00, 26.49it/s] 60%|    | 15/25 [00:00<00:00, 23.24it/s] 72%|  | 18/25 [00:00<00:00, 21.91it/s] 84%| | 21/25 [00:00<00:00, 21.17it/s] 96%|| 24/25 [00:01<00:00, 20.47it/s]100%|| 25/25 [00:01<00:00, 22.51it/s]
torch.Size([1, 50432])
>> gpt_gen_time: 1.41 seconds
>> gpt_forward_time: 0.01 seconds
>> s2mel_time: 1.11 seconds
>> bigvgan_time: 0.13 seconds
>> Total inference time: 3.20 seconds
>> Generated audio length: 2.29 seconds
>> RTF: 1.3971
>> wav file saved to: D:\ZhiMoAi_shuzi\unified_outputs\tts_1771855862.wav
>> starting inference...
Use the specified emotion vector
The following generation flags are not valid and may be ignored: ['length_penalty']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
  0%|          | 0/25 [00:00<?, ?it/s]  4%|         | 1/25 [00:00<00:03,  6.46it/s] 24%|       | 6/25 [00:00<00:00, 23.43it/s] 36%|      | 9/25 [00:00<00:01, 15.81it/s] 44%|     | 11/25 [00:00<00:00, 14.14it/s] 52%|    | 13/25 [00:00<00:00, 13.12it/s] 60%|    | 15/25 [00:01<00:00, 12.41it/s] 68%|   | 17/25 [00:01<00:00, 11.94it/s] 76%|  | 19/25 [00:01<00:00, 11.65it/s] 84%| | 21/25 [00:01<00:00, 11.47it/s] 92%|| 23/25 [00:01<00:00, 11.35it/s]100%|| 25/25 [00:02<00:00, 11.26it/s]100%|| 25/25 [00:02<00:00, 12.45it/s]
torch.Size([1, 229376])
>> gpt_gen_time: 6.22 seconds
>> gpt_forward_time: 0.02 seconds
>> s2mel_time: 2.03 seconds
>> bigvgan_time: 0.22 seconds
>> Total inference time: 8.88 seconds
>> Generated audio length: 10.40 seconds
>> RTF: 0.8532
>> wav file saved to: D:\ZhiMoAi_shuzi\unified_outputs\tts_1771855883.wav
>> starting inference...
Use the specified emotion vector
  0%|          | 0/25 [00:00<?, ?it/s] 20%|        | 5/25 [00:00<00:00, 39.70it/s] 36%|      | 9/25 [00:00<00:00, 16.89it/s] 48%|     | 12/25 [00:00<00:00, 14.30it/s] 56%|    | 14/25 [00:00<00:00, 13.30it/s] 64%|   | 16/25 [00:01<00:00, 12.67it/s] 72%|  | 18/25 [00:01<00:00, 12.28it/s] 80%|  | 20/25 [00:01<00:00, 11.79it/s] 88%| | 22/25 [00:01<00:00, 11.48it/s] 96%|| 24/25 [00:01<00:00, 11.32it/s]100%|| 25/25 [00:01<00:00, 12.97it/s]
torch.Size([1, 212480])
>> gpt_gen_time: 6.79 seconds
>> gpt_forward_time: 0.01 seconds
>> s2mel_time: 1.95 seconds
>> bigvgan_time: 0.23 seconds
>> Total inference time: 9.36 seconds
>> Generated audio length: 9.64 seconds
>> RTF: 0.9711
>> wav file saved to: D:\ZhiMoAi_shuzi\unified_outputs\tts_1771855905.wav
